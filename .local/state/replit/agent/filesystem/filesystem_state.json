{"file_contents":{"style.css":{"content":"/* mobile-first simple styling */\n*{box-sizing:border-box;font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial;}\nbody,html,#app{height:100%;margin:0;padding:0;background:#f6f7fb;color:#111;}\nheader{display:flex;justify-content:space-between;align-items:center;padding:12px;background:#fff;box-shadow:0 1px 3px rgba(0,0,0,.06);}\nh1{font-size:18px;margin:0;}\n#map-container{position:relative;margin:12px;border-radius:12px;overflow:hidden;background:#ddd;}\n#map-img{display:block;width:100%;height:auto;max-height:70vh;object-fit:cover;}\n#markers{position:absolute;top:0;left:0;right:0;bottom:0;pointer-events:none;}\n.marker{\n  position:absolute; transform:translate(-50%,-100%);\n  width:36px;height:36px;border-radius:50%;\n  display:flex;align-items:center;justify-content:center;\n  font-size:12px;color:#fff;pointer-events:auto;cursor:pointer;\n  box-shadow:0 2px 6px rgba(0,0,0,.2);\n}\n.marker.open{background:#2ecc71;}\n.marker.closed{background:#e74c3c;}\n.marker.queue{background:#f1c40f;}\n.modal-backdrop{position:fixed;inset:0;background:rgba(0,0,0,.45);display:flex;align-items:center;justify-content:center;}\n.hidden{display:none;}\n#modal-card{width:92%;max-width:420px;padding:16px;background:#fff;border-radius:12px;position:relative;}\n#closeModal{position:absolute;right:10px;top:8px;border:none;background:transparent;font-size:20px;}\n#queue-actions{display:flex;gap:8px;margin-top:12px;}\nbutton{padding:10px 12px;border-radius:8px;border:none;background:#3b82f6;color:#fff;}\nbutton[disabled]{opacity:.6}\nfooter{text-align:center;padding:10px 0;font-size:12px;color:#666;}\n#admin-area{margin-top:12px;border-top:1px solid #eee;padding-top:10px;display:flex;gap:8px;align-items:center;}\n@media(min-width:700px){\n  #map-img{max-height:80vh;}\n}\n","size_bytes":1765},"README.md":{"content":"","size_bytes":0},"app.js":{"content":"// ====== CONFIG: paste your firebaseConfig below ======\nconst firebaseConfig = {\n  apiKey: \"AIzaSyCMMEBa1FU-ZfA7aIr043gPFDB4QgUy4-o\",\n  authDomain: \"rancho-bathroom-app.firebaseapp.com\",\n  databaseURL: \"https://rancho-bathroom-app-default-rtdb.firebaseio.com\",\n  projectId: \"rancho-bathroom-app\",\n  storageBucket: \"rancho-bathroom-app.firebasestorage.app\",\n  messagingSenderId: \"614863075730\",\n  appId: \"1:614863075730:web:ebca60bdc7e0c6442ee94b\",\n  measurementId: \"G-5V41FQ9DHR\"\n};\n// =====================================================\n\nfirebase.initializeApp(firebaseConfig);\nconst db = firebase.database();\n\nconst markersContainer = document.getElementById('markers');\nconst refreshBtn = document.getElementById('refreshBtn');\nconst modal = document.getElementById('modal');\nconst closeModal = document.getElementById('closeModal');\nconst modalTitle = document.getElementById('modal-title');\nconst modalStatus = document.getElementById('modal-status');\nconst modalQueueCount = document.getElementById('modal-queue-count');\nconst joinBtn = document.getElementById('joinBtn');\nconst leaveBtn = document.getElementById('leaveBtn');\nconst adminArea = document.getElementById('admin-area');\nconst adminStatus = document.getElementById('adminStatus');\nconst saveAdmin = document.getElementById('saveAdmin');\n\nlet bathrooms = {}; // local cache\nlet currentBathId = null;\nlet username = localStorage.getItem('username') || prompt(\"Enter a display name for queues\") || 'anon';\nlocalStorage.setItem('username', username);\n\n// Utility to create markers on map from DB data\nfunction renderMarkers(){\n  markersContainer.innerHTML = '';\n  Object.keys(bathrooms).forEach(id => {\n    const b = bathrooms[id];\n    const el = document.createElement('div');\n    el.className = 'marker ' + (b.status === 'open' ? 'open' : (b.queue && b.queue.length ? 'queue' : 'closed'));\n    el.style.left = (b.xPercent || 50) + '%';\n    el.style.top = (b.yPercent || 50) + '%';\n    el.dataset.id = id;\n    el.title = `${b.name} â€” ${b.status}`;\n    el.innerText = b.queue ? String(b.queue.length) : '0';\n    el.addEventListener('click', () => openModal(id));\n    markersContainer.appendChild(el);\n  });\n}\n\n// Load from Firebase once, and subscribe to updates\nfunction subscribeToBathrooms(){\n  const ref = db.ref('bathrooms');\n  ref.on('value', snapshot => {\n    const val = snapshot.val() || {};\n    bathrooms = val;\n    renderMarkers();\n    // if modal open for current, update modal\n    if(currentBathId) populateModal(currentBathId);\n  });\n}\n\nfunction openModal(id){\n  currentBathId = id;\n  populateModal(id);\n  modal.classList.remove('hidden');\n  modal.style.position = 'fixed';\n  modal.style.inset = 0;\n  modal.querySelector('#modal-card').scrollIntoView();\n}\n\nfunction populateModal(id){\n  const b = bathrooms[id];\n  if(!b) return;\n  modalTitle.innerText = b.name;\n  modalStatus.innerText = `Status: ${b.status || 'unknown'}`;\n  modalQueueCount.innerText = `Queue: ${b.queue ? b.queue.length : 0}`;\n  // show/hide join/leave\n  const inQueue = (b.queue || []).includes(username);\n  joinBtn.disabled = (b.status !== 'open');\n  joinBtn.classList.toggle('hidden', inQueue);\n  leaveBtn.classList.toggle('hidden', !inQueue);\n  // admin area\n  adminStatus.value = b.status || 'open';\n}\n\n// Join queue\njoinBtn.addEventListener('click', async () => {\n  if(!currentBathId) return;\n  const ref = db.ref(`bathrooms/${currentBathId}/queue`);\n  const snap = await ref.once('value');\n  let q = snap.val() || [];\n  if(q.includes(username)) return;\n  q.push(username);\n  await ref.set(q);\n});\n\n// Leave queue\nleaveBtn.addEventListener('click', async () => {\n  if(!currentBathId) return;\n  const ref = db.ref(`bathrooms/${currentBathId}/queue`);\n  const snap = await ref.once('value');\n  let q = snap.val() || [];\n  q = q.filter(u => u !== username);\n  await ref.set(q);\n});\n\n// Admin save\nsaveAdmin.addEventListener('click', async () => {\n  if(!currentBathId) return;\n  const newStatus = adminStatus.value;\n  await db.ref(`bathrooms/${currentBathId}/status`).set(newStatus);\n  // optionally clear queue when closed\n  if(newStatus !== 'open'){\n    await db.ref(`bathrooms/${currentBathId}/queue`).set([]);\n  }\n});\n\n// close modal\ncloseModal.addEventListener('click', () => {\n  modal.classList.add('hidden');\n  currentBathId = null;\n});\n\n// refresh\nrefreshBtn.addEventListener('click', () => subscribeToBathrooms());\n\n// initial\nsubscribeToBathrooms();\n","size_bytes":4415}},"version":2}